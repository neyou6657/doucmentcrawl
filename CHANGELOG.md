# 更新日志

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [1.1.0] - 2024

### 新增功能

#### 🎯 可视化元素选择器
- ✨ 类似 Chrome DevTools 的元素选择功能
- 🖱️ 鼠标悬停时实时高亮元素（橙色边框）
- 🎨 黑色提示框显示元素信息和选择器
- 🔍 智能选择器生成算法
- ⌨️ 支持 ESC 键取消选择
- 📊 即时显示将匹配的链接数量
- 🎯 分别选择链接区域和内容区域
- 💡 屏幕中央显示操作提示（3秒后消失）

#### 选择器生成优化
- 🏆 优先使用 ID 选择器（最高优先级）
- 🎨 智能类选择器组合
- 🔤 标签+类选择器
- 🏷️ 属性选择器（role、data-* 等）
- 🛤️ 路径选择器作为后备方案
- 🔗 自动为链接区域添加 ` a` 后缀
- 🚫 过滤动态状态类（hover、active、focus）

#### 用户体验改进
- 🎨 新增"手动选择区域"部分在控制面板
- 🎯 两个醒目的选择按钮（粉色和紫色）
- 📝 实时显示当前选中的选择器
- ✅ 选择后立即显示确认提示
- 🔄 支持重复选择（新选择覆盖旧选择）
- 🚫 自动忽略控制面板本身
- 📖 详细的使用指南文档

#### 文档更新
- 📚 新增 `ELEMENT_PICKER_GUIDE.md` 详细使用指南
- 🎨 新增 `demo.html` 交互式演示页面
- 📖 更新 README.md 添加新功能说明
- 💡 添加使用技巧和最佳实践
- ❌ 添加常见问题解答

### 改进

#### 代码结构
- 🏗️ 新增 `elementPickerState` 状态管理
- 🎯 模块化的选择器生成函数
- 🎨 优化高亮和提示框逻辑
- 🧹 清理事件监听器机制

#### 配置系统
- ⚙️ 新增 `customLinkSelector` 配置项
- ⚙️ 新增 `customContentSelector` 配置项
- 🔄 优先使用用户自定义选择器
- 📝 配置项文档完善

### 技术细节

#### 新增函数
- `startElementPicker(mode)` - 开始元素选择
- `stopElementPicker()` - 停止元素选择
- `generateBestSelector(element)` - 智能选择器生成
- `generateSelector(element)` - 路径选择器生成
- `highlightElement(element)` - 高亮元素
- `updateTooltip(element)` - 更新提示框
- `handleMouseMove(e)` - 处理鼠标移动
- `handleClick(e)` - 处理点击事件
- `handleKeyDown(e)` - 处理键盘事件
- `updateSelectorDisplay()` - 更新选择器显示

#### 事件处理
- 鼠标移动事件监听
- 点击事件捕获
- ESC 键取消功能
- 动态元素创建和清理

## [1.0.0] - 2024

### 新增功能

#### 核心功能
- ✨ 智能左侧导航栏链接扫描
- 🎯 基于URL路径的自动分类系统
- 📄 支持CSS选择器和XPath的内容提取
- 💾 多格式导出（JSON、Markdown、CSV）
- 🔄 批量页面抓取引擎

#### 用户界面
- 🎨 可视化控制面板
- 📊 实时进度条显示
- 📈 抓取统计信息
- 🎛️ 可配置的延迟和并发参数

#### 内容提取
- 📝 自动提取页面标题（h1-h6）
- 💻 代码块提取和语言识别
- 📋 表格数据提取
- 🔗 链接关系分析
- 🏷️ 元数据提取

#### 高级特性
- ⚡ 并发控制系统（支持1-N个并发请求）
- ⏱️ 可配置的请求延迟
- 🔍 多种内容选择器支持
- 🎯 自定义XPath查询
- 🔄 增量更新支持（通过缓存）

#### 导出功能
- 📦 JSON格式导出（结构化数据）
- 📝 Markdown格式导出（可读性文档）
- 📊 CSV格式导出（表格数据）
- 🎨 格式化输出（可配置缩进）

#### 分类系统
- 📂 基于URL路径自动分类
- 🏷️ 显示每个分类的链接数量
- 🗂️ 分类统计和可视化
- 🔍 支持过滤特定分类

#### 容错处理
- 🛡️ 错误捕获和处理
- 📝 失败请求日志
- 🔄 自动重试机制（可选）
- ⚠️ 友好的错误提示

### 技术实现

#### 依赖库
- JSZip 3.10.1（用于可能的批量打包）
- Tampermonkey GM API（跨域请求、文件下载等）

#### API使用
- `GM_xmlhttpRequest` - 跨域HTTP请求
- `GM_download` - 文件下载
- `GM_setClipboard` - 剪贴板操作
- `GM_registerMenuCommand` - 菜单注册

#### 性能优化
- 使用Map进行去重（O(1)查找）
- Promise.race实现并发控制
- DOMParser复用避免内存泄漏
- 增量DOM更新避免UI阻塞

### 文档

#### 新增文档
- 📖 完整的README.md文档
- 📚 使用示例文档（examples.md）
- ⚙️ 配置示例文件（config.example.js）
- 📜 更新日志（CHANGELOG.md）
- ⚖️ MIT许可证（LICENSE）

#### 配置示例
- 常见文档网站配置（MDN、React、Vue等）
- 抓取策略配置（快速、平衡、安全、礼貌）
- 内容提取规则
- 过滤规则
- 分类规则
- 导出选项

#### 使用示例
- 15个实际使用场景示例
- 从基础到高级的完整教程
- 控制台脚本示例
- 自定义XPath示例
- 性能优化技巧

### 支持的网站类型

- ✅ MDN Web Docs
- ✅ React 文档
- ✅ Vue.js 文档
- ✅ GitBook 站点
- ✅ Docusaurus 站点
- ✅ 通用文档网站

### 已知限制

- 需要在支持Tampermonkey的浏览器中运行
- 部分动态加载的内容可能需要额外配置
- 跨域限制需要GM权限
- 大量页面抓取可能耗时较长

### 安全和隐私

- 所有数据处理都在本地进行
- 不上传或发送任何数据到第三方
- 遵守同源策略和CORS规则
- 建议遵守目标网站的robots.txt

---

## 未来计划

### [1.1.0] - 计划中

#### 新功能
- [ ] 增加HTML格式导出
- [ ] 支持图片下载和本地化
- [ ] 添加全文搜索功能
- [ ] 实现数据缓存系统
- [ ] 支持断点续传
- [ ] 添加更多预设配置

#### 改进
- [ ] 优化大文件处理
- [ ] 改进错误提示信息
- [ ] 增强XPath构建器
- [ ] 添加配置导入导出
- [ ] 改进UI/UX设计

#### 文档
- [ ] 添加视频教程
- [ ] 更多实际案例
- [ ] API参考文档
- [ ] 故障排除指南

### [2.0.0] - 远期计划

#### 重大更新
- [ ] 重构为模块化架构
- [ ] 支持插件系统
- [ ] Web Worker多线程
- [ ] IndexedDB持久化存储
- [ ] AI智能分类
- [ ] OCR图片文字识别
- [ ] PDF生成
- [ ] 电子书格式导出（EPUB）

---

## 版本说明

### 语义化版本规则

- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 变更类型

- **新增** - 新功能
- **修改** - 已有功能的变更
- **弃用** - 即将移除的功能
- **移除** - 已移除的功能
- **修复** - 问题修复
- **安全** - 安全性相关的修复

---

## 贡献

欢迎提交问题报告和功能建议！如果你想贡献代码，请遵循以下步骤：

1. Fork 项目
2. 创建功能分支
3. 提交你的修改
4. 推送到分支
5. 创建 Pull Request

---

## 联系方式

- 问题报告：通过 GitHub Issues
- 功能建议：通过 GitHub Discussions
- 安全问题：请通过私密方式报告

---

*最后更新：2024*
